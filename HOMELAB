HOMELAB

NEW MACHINE

This repository's flake has a configuration for building a bootable NixOS ISO
image, packed with OpenSSH server and a public key, which makes it possible to
carry out the install via SSH.

NEW MACHINE - CONNECTED INSTALL

1. Build the iso with 'make iso'
2. Boot the new machine (physical or virtual) from built iso.
3. Get the IP address of the new machine.
4. Connect and do the install manually with 
   'make connected-install MACHINE_IP=<machine-ip> MACHINE_NAME=<machine-name>'

NEW MACHINE - REMOTE INSTALL

1. Build the iso with 'make iso'
2. Boot the new machine (physical or virtual) from built iso.
3. Get the IP address of the new machine.
4. Connect and do the install manually with 
   'make remote-install MACHINE_IP=<machine-ip> MACHINE_NAME=<machine-name>'

NEW MACHINE - POST INSTALL

When the machine is installed, a new hardware-configuration.nix file has been
created in '/etc/nixos/hardware-configuration.nix'. So directly after the
install, this file is not in version control. 

To fix this run the post install script 'make post-install
MACHINE_NAME=<machine-name> MACHINE_IP=<machine-ip>' which will copy the new
hardware-configuration.nix file to the repository and add it to version
control.
